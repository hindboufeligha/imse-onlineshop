{% include 'includes/header.html' %}

<!-- ***** Main Banner Area Start ***** -->
<div class="page-heading" id="top">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="inner-content">
                    <h2>{{ product.p_name }}</h2>
                    <!--<span> {{ product.p_description }}</span>-->
                </div>
            </div>
        </div>
    </div>
</div>
<!-- ***** Main Banner Area End ***** -->


<!-- ***** Product Area Starts ***** -->
<section class="section" id="product" data-product-id="{{product.p_id}}">
    <div class="container">
        <div class="row">
            <div class="col-lg-8">
                <div class="left-images">
                    <img src="{{ product.p_image_url }}" alt="">
                    <!--<img src="../assets/images/single-product-02.jpg" alt="">-->
                </div>
            </div>
            <div class="col-lg-4">
                <div class="right-content">
                    <h4>{{ product.p_name }}</h4>
                    <span class="price">{{ product.p_price }} €</span>
                    <ul class="stars">
                        <li><i class="fa fa-star"></i></li>
                        <li><i class="fa fa-star"></i></li>
                        <li><i class="fa fa-star"></i></li>
                        <li><i class="fa fa-star"></i></li>
                        <li><i class="fa fa-star"></i></li>
                    </ul>
                    <div class="product-description">
                        <span>{{ product.p_description }}</span>
                    </div>

                    <!-- 
                    <div class="quote">
                        <i class="fa fa-quote-left"></i>
                        <p>Something unique about this product!</p>
                    </div>
                    -->

                    <form method="POST">
                        <!-- Select Size -->
                        <div class="size-form-group">
                            <div class="left-content">
                                <h4>Size:</h4>
                            </div>
                            <div class="right-content">
                                <div class="select-size">

                                    <select class="form-control" id="size" name="size">
                                        {% for size in sizes %}
                                        <option value="{{ size.name }}">{{ size.name }}</option>

                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                        </div>



                        <!-- Select Quantity -->
                        <div class="quantity-content">
                            <div class="left-content">
                                <h6>Quantity:</h6>
                            </div>
                            <div class="right-content">
                                <div class="quantity buttons_added">
                                    <input type="button" value="-" class="minus"><input type="number" step="1" min="1"
                                        max="" name="quantity" value="1" title="Qty" class="input-text qty text"
                                        size="4" pattern="" inputmode=""><input type="button" value="+" class="plus">
                                </div>
                            </div>
                        </div>
                        <div class="total">
                            <h4>Total: $210.00</h4>
                            <div class="main-border-button"><a href="#">Add To Cart</a></div>
                        </div>

                    </form>

                </div>
            </div>
        </div>
    </div>
</section>
<!-- ***** Product Area Ends ***** -->

<!-- ***** Footer Start ***** -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-3">
                <div class="first-item">
                    <div class="logo">
                        <img src="../assets/images/logo.png" style=" width:100px; height:100px;">
                    </div>
                    <ul>
                        <li><a href="#">online brand shop, wien, 1120, Austeria</a></li>
                        <li><a href="#">onlinebrandshop@company.com</a></li>
                        <li><a href="#">00430-020-0340</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-lg-3">
                <h4>Shopping &amp; Categories</h4>
                <ul>
                    <li><a href="#">Men’s Shopping</a></li>
                    <li><a href="#">Women’s Shopping</a></li>
                    <li><a href="#">Kid's Shopping</a></li>
                </ul>
            </div>
            <div class="col-lg-3">
                <h4>Useful Links</h4>
                <ul>
                    <li><a href="#">Homepage</a></li>
                    <li><a href="#">About Us</a></li>
                    <li><a href="#">Help</a></li>
                    <li><a href="#">Contact Us</a></li>
                </ul>
            </div>
            <div class="col-lg-3">
                <h4>Help &amp; Information</h4>
                <ul>
                    <li><a href="#">Help</a></li>
                    <li><a href="#">FAQ's</a></li>
                    <li><a href="#">Shipping</a></li>
                    <li><a href="#">Tracking ID</a></li>
                </ul>
            </div>
            <div class="col-lg-12">
                <div class="under-footer">
                    <p>Copyright © 2023 onlineshop Co., Ltd. All Rights Reserved.
                    </p>
                    <ul>
                        <li><a href="#"><i class="fa fa-facebook"></i></a></li>
                        <li><a href="#"><i class="fa fa-twitter"></i></a></li>
                        <li><a href="#"><i class="fa fa-linkedin"></i></a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</footer>


<!-- jQuery Libraries -->
<script src="../assets/js/jquery-2.1.0.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<!-- Bootstrap -->
<script src="../assets/js/popper.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>

<!-- Plugins -->
<script src="../assets/js/owl-carousel.js"></script>
<script src="../assets/js/accordions.js"></script>
<script src="../assets/js/datepicker.js"></script>
<script src="../assets/js/scrollreveal.min.js"></script>
<script src="../assets/js/waypoints.min.js"></script>
<script src="../assets/js/jquery.counterup.min.js"></script>
<script src="../assets/js/imgfix.min.js"></script>
<script src="../assets/js/slick.js"></script>
<script src="../assets/js/lightbox.js"></script>
<script src="../assets/js/isotope.js"></script>
<script src="../assets/js/quantity.js"></script>

<!-- Global Init -->
<script src="../assets/js/custom.js"></script>

<script>

    $(function () {
        var selectedClass = "";
        $("p").click(function () {
            selectedClass = $(this).attr("data-rel");
            $("#portfolio").fadeTo(50, 0.1);
            $("#portfolio div").not("." + selectedClass).fadeOut();
            setTimeout(function () {
                $("." + selectedClass).fadeIn();
                $("#portfolio").fadeTo(50, 1);
            }, 500);

        });
    });

</script>

<!-- Update sized and quantities of the selected (current )product -->
<script>

    var productID = '{{product.p_id}}'
    function updateSizesandQuantitiesAvailable(productID) {
        //make an AJAX request to the server to fetch sizes and quantities associated with the current product
        $.ajax({
            type: 'GET',
            url: '/single-product.html/<product_id>',
            data: { productID: productID },
            success: function (response) {
                // Update the dropdown of available sizes:
                var selectSize = $('#size');
                selectSize.empty();


                // Append options based on the response from the server:
                $.each(response.sizes, function (index, size) {
                    selectSize.append($('<option>', {
                        value: size.name.toLowerCase(),
                        text: size.name
                    }));
                });

                // Update the avalaible quantities associated with the selected size:
                updateQuantitiesAvailable(response.sizes);
            },

            error: function (error) {
                console.error('Error fetching sized and quantities from db: ', error);
            }
        });

    }

    // Update the availbale quantities based on the selected size:
    function updateQuantitiesAvailable(sizes) {
        var selectQuantity = $('[name="quantity"]');
        var selectedSize = $('#size').val();

        // Find the quantity available that corresponds to the selected size:
        var quantity = sizes.find(function (size) {
            return size.name.toLowerCase() === selectedSize;
        }).quantity;


        // Update the max attribute of the quantity input:
        selectQuantity.attr('max', quantity);
    }


    // Event handler for product selection (we need to trigger this when the user selects a product)
    $('#product-select').change(function () {
        var selectedProductID = $(this).val();
        updateSizesandQuantitiesAvailable(selectedProductID)
    });

</script>

</body>

</html>